<!doctype html>
















<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="ko-KR" 
  
    data-mode="light"
  
>
  <!-- The Head -->

<head>
     
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  >

  

  

  
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="PySet을 Go답게" />
<meta property="og:locale" content="ko_KR" />
<meta name="description" content="PySet은 아주 유용한 자료구조이다. 이를 Go로 Go스럽게 구현하기 위해 CPython의 소스코드와 golang 소스코드를 살펴보았다. set과 map이 뒤에서 어떻게 작동하는지를 살펴보고 가장 합리적인 방법으로 집합을 구현해보려 한다." />
<meta property="og:description" content="PySet은 아주 유용한 자료구조이다. 이를 Go로 Go스럽게 구현하기 위해 CPython의 소스코드와 golang 소스코드를 살펴보았다. set과 map이 뒤에서 어떻게 작동하는지를 살펴보고 가장 합리적인 방법으로 집합을 구현해보려 한다." />
<link rel="canonical" href="https://denev6.github.io/playground/2023/10/03/goset.html" />
<meta property="og:url" content="https://denev6.github.io/playground/2023/10/03/goset.html" />
<meta property="og:site_name" content="Palette" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-10-03T00:00:00+09:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="PySet을 Go답게" />
<meta name="twitter:site" content="@" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-10-03T00:00:00+09:00","datePublished":"2023-10-03T00:00:00+09:00","description":"PySet은 아주 유용한 자료구조이다. 이를 Go로 Go스럽게 구현하기 위해 CPython의 소스코드와 golang 소스코드를 살펴보았다. set과 map이 뒤에서 어떻게 작동하는지를 살펴보고 가장 합리적인 방법으로 집합을 구현해보려 한다.","headline":"PySet을 Go답게","mainEntityOfPage":{"@type":"WebPage","@id":"https://denev6.github.io/playground/2023/10/03/goset.html"},"url":"https://denev6.github.io/playground/2023/10/03/goset.html"}</script>
<!-- End Jekyll SEO tag -->

  

  <title>PySet을 Go답게 | 
Palette
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">
<link rel="manifest" href="/assets/img/favicons/site.webmanifest">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Palette">
<meta name="application-name" content="Palette">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin>
    
      <link rel="preconnect" href="https://fonts.googleapis.com" >
      <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
    
      <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
    

    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">
  

  <!-- GA -->
  

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.2/css/all.min.css">

  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.21.1/dist/tocbot.min.css">
  

  
    <!-- Manific Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css">
  

  <!-- JavaScript -->

  

  <!-- A placeholder to allow defining custom metadata -->
<meta property="og:image" content="/assets/img/preview.jpg">
</head>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      TeX: {
        equationNumbers: {
          autoNumber: "AMS"
        }
      },
      tex2jax: {
      inlineMath: [ ['$', '$'] ],
      displayMath: [ ['$$', '$$'], ['\\[', '\\]'] ],
      processEscapes: true,
    }
  });
  MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
        alert("Math Processing Error: "+message[1]);
      });
  MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
        alert("Math Processing Error: "+message[1]);
      });
</script>
<script
  type="text/javascript"
  async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"
></script>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle">
      
      
      <img src="/assets/img/avatar.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'">
      
    </a>

    <h1 class="site-title">
      <a href="/">Palette</a>
    </h1>
    <p class="site-subtitle fst-italic mb-0">개발자 노트</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>홈</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>소개</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>카테고리</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>기록</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>태그</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
    

    
    <a href="https://github.com/denev6
" aria-label="github"  
      target="_blank"    
      rel="noopener noreferrer" >
      <i class="fab fa-github"></i>
    </a>
    
    
    

    
    <a href="https://denev6.tistory.com/" aria-label="blog"  
      target="_blank"    
      rel="noopener noreferrer" >
      <i class="fa-solid fa-pen"></i>
    </a>
    
    
    

    
    <a href="https://www.linkedin.com/in/denev6" aria-label="linkedin"  
      target="_blank"    
      rel="noopener noreferrer" >
      <i class="fab fa-linkedin"></i>
    </a>
    
    
    

    
    <a href="/feed.xml" aria-label="rss"  
      target="_blank"    
      rel="noopener noreferrer" >
      <i class="fas fa-rss"></i>
    </a>
    
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">
                홈
              </a>
            </span>

          
        
          
        
          
        
          
        
          
        
          
            
              <span>PySet을 Go답게</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      
글
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="검색..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">취소</button>
  </div>
</header>


        <div class="row">
          <main
            aria-label="Main Content"
            class="col-12 col-lg-11 col-xl-9 px-md-4"
          >
            

<article class="px-1">
  
    
  
    <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->


<!-- images -->




<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    
      

      
      

      
      
      

      

    

    

  

  
  

  

  
  

  




<!-- return -->




<header>
  <h1 data-toc-skip>PySet을 Go답게</h1>

  <div class="post-meta text-muted">
    <!-- published date -->
    <span>
      게시
      <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1696258800"
  data-df="YYYY/MM/DD"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  2023/10/03
</time>

    </span>

    

    <div class="d-flex justify-content-between">
      <!-- author(s) -->
      <span>
        

        By

        <em>
          
            <a href="https://github.com/denev6">박성진</a>
          
        </em>
      </span>

      <!-- read time -->
      <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<!--
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="2646 단어"
>
  <em>14 
분</em>
읽는 시간
</span>
-->

    </div>
    <!-- .d-flex -->
  </div>
  <!-- .post-meta -->
</header>


<div class="content">
  <p><code class="language-plaintext highlighter-rouge">PySet</code>은 아주 유용한 자료구조이다. 이를 <code class="language-plaintext highlighter-rouge">Go</code>로 Go스럽게 구현하기 위해 <code class="language-plaintext highlighter-rouge">CPython</code>의 소스코드와 <code class="language-plaintext highlighter-rouge">golang</code> 소스코드를 살펴보았다. <code class="language-plaintext highlighter-rouge">set</code>과 <code class="language-plaintext highlighter-rouge">map</code>이 뒤에서 어떻게 작동하는지를 살펴보고 가장 합리적인 방법으로 집합을 구현해보려 한다.</p>

<hr />

<h2 id="문제"><span class="me-2">문제</span><a href="#문제" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p><code class="language-plaintext highlighter-rouge">Python</code>에는 <code class="language-plaintext highlighter-rouge">집합</code>이라는 아주 유용한 구조가 있다. <code class="language-plaintext highlighter-rouge">set</code> 객체는 크게 2가지 역할이 있는데, 중복 값을 제거하는 것과 빠르게 값을 탐색하는 것이다.</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
<span class="n">n</span> <span class="o">=</span> <span class="nf">set</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="c1"># {1, 3, 5, 6, 8}
</span>
<span class="n">has_three</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span> <span class="ow">in</span> <span class="n">n</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">has_three</span><span class="p">)</span>
<span class="c1"># True
</span></pre></td></tr></tbody></table></code></div></div>

<p>하지만 <code class="language-plaintext highlighter-rouge">Go</code>는 <code class="language-plaintext highlighter-rouge">set</code>을 제공하지 않는다. 따라서 <code class="language-plaintext highlighter-rouge">set</code>과 유사하게 작동하는 객체를 만들어보려 한다. 그런데 <code class="language-plaintext highlighter-rouge">Go</code>를 곁들인.</p>

<hr />

<h2 id="cpython의-set-분석"><span class="me-2">CPython의 Set 분석</span><a href="#cpython의-set-분석" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p><code class="language-plaintext highlighter-rouge">Python</code>의 구현체인 <code class="language-plaintext highlighter-rouge">C</code>코드를 뜯어보자. 코드는 <a href="https://github.com/python/cpython/blob/main/Include/cpython/setobject.h">Github-python</a>에 공개되어 있다.</p>

<div file="cpython/Include/cpython/setobject.h" class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="cpython/Include/cpython/setobject.h"><i class="far fa-file-code fa-fw"></i></span>
      <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">PyObject</span> <span class="o">*</span><span class="n">key</span><span class="p">;</span>
    <span class="n">Py_hash_t</span> <span class="n">hash</span><span class="p">;</span>             <span class="cm">/* Cached hash code of the key */</span>
<span class="p">}</span> <span class="n">setentry</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">PyObject_HEAD</span>
    <span class="n">Py_ssize_t</span> <span class="n">fill</span><span class="p">;</span>            <span class="cm">/* Number active and dummy entries*/</span>
    <span class="n">Py_ssize_t</span> <span class="n">used</span><span class="p">;</span>            <span class="cm">/* Number active entries */</span>
    <span class="n">Py_ssize_t</span> <span class="n">mask</span><span class="p">;</span>
    <span class="n">setentry</span> <span class="o">*</span><span class="n">table</span><span class="p">;</span>
    <span class="n">Py_hash_t</span> <span class="n">hash</span><span class="p">;</span>             <span class="cm">/* Only used by frozenset objects */</span>
    <span class="n">Py_ssize_t</span> <span class="n">finger</span><span class="p">;</span>          <span class="cm">/* Search finger for pop() */</span>
    <span class="n">setentry</span> <span class="n">smalltable</span><span class="p">[</span><span class="n">PySet_MINSIZE</span><span class="p">];</span>
    <span class="n">PyObject</span> <span class="o">*</span><span class="n">weakreflist</span><span class="p">;</span>      <span class="cm">/* List of weak references */</span>
<span class="p">}</span> <span class="n">PySetObject</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>핵심은 <code class="language-plaintext highlighter-rouge">setentry</code>이다. <code class="language-plaintext highlighter-rouge">setentry</code>를 보면 <code class="language-plaintext highlighter-rouge">key</code>를 가지고 있고, 주석을 통해 <code class="language-plaintext highlighter-rouge">key</code>를 hash한다는 걸 알 수 있다. 즉, <code class="language-plaintext highlighter-rouge">PySet</code>은 <code class="language-plaintext highlighter-rouge">Hash Table</code>의 구조를 가지고 있다고 추측해 볼 수 있다.</p>

<div file="cpython/Objects/setobject.c" class="language-c highlighter-rouge"><div class="code-header">
        <span data-label-text="cpython/Objects/setobject.c"><i class="far fa-file-code fa-fw"></i></span>
      <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre>
<span class="cm">/* set object implementation

   Written and maintained by Raymond D. Hettinger &lt;python@rcn.com&gt;
   Derived from Lib/sets.py and Objects/dictobject.c.

   The basic lookup function used by all operations.
   This is based on Algorithm D from Knuth Vol. 3, Sec. 6.4.

   ...
*/</span>
</pre></td></tr></tbody></table></code></div></div>

<p><code class="language-plaintext highlighter-rouge">set</code>을 구현한 파일의 첫 주석이다. <code class="language-plaintext highlighter-rouge">set</code>은 <code class="language-plaintext highlighter-rouge">dict</code> 객체에서 파생되었다고 언급하고 있다. 이 주석을 통해 <code class="language-plaintext highlighter-rouge">set</code>이 <code class="language-plaintext highlighter-rouge">Hash Table</code> 구조를 사용한다는 것을 알 수 있다.</p>

<p>쉽게 말해, <code class="language-plaintext highlighter-rouge">PySet</code>은 <code class="language-plaintext highlighter-rouge">key</code>만 있는 <code class="language-plaintext highlighter-rouge">PyDict</code>이다.</p>

<hr />

<h2 id="go-map-분석"><span class="me-2">Go Map 분석</span><a href="#go-map-분석" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p><code class="language-plaintext highlighter-rouge">Go</code>는 <code class="language-plaintext highlighter-rouge">map</code>이라는 자료구조를 제공한다. 이는 <code class="language-plaintext highlighter-rouge">{key:value}</code>로 매핑되는 <code class="language-plaintext highlighter-rouge">Hash table</code>이다. 이를 통해 <code class="language-plaintext highlighter-rouge">set</code>을 구현할 수 있을 것 같다. 그런데 <code class="language-plaintext highlighter-rouge">value</code>는 필요하지 않다. 따라서 value 자리에 <code class="language-plaintext highlighter-rouge">zero-value</code>를 넣어 마치 값이 없는 것과 같은 효과를 낼 수 있다.</p>

<div class="language-go highlighter-rouge"><div class="code-header">
        <span data-label-text="Go"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="c">// nil</span>
<span class="k">map</span><span class="p">[</span><span class="n">T</span><span class="p">]</span><span class="k">interface</span><span class="p">{}{}</span>
<span class="k">map</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="no">nil</span>

<span class="c">// struct</span>
<span class="k">map</span><span class="p">[</span><span class="n">T</span><span class="p">]</span><span class="k">struct</span><span class="p">{}{}</span>
<span class="k">map</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="k">struct</span><span class="p">{}{}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>대표적으로 <code class="language-plaintext highlighter-rouge">nil</code>과 <code class="language-plaintext highlighter-rouge">빈 struct</code>가 있다. 따라서 둘 중 어떤 값이 더 효과적일지 판단해야 한다.</p>

<h3 id="interface와-메모리-자원"><span class="me-2">interface와 메모리 자원</span><a href="#interface와-메모리-자원" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="language-go highlighter-rouge"><div class="code-header">
        <span data-label-text="Go"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="k">import</span> <span class="p">(</span>
  <span class="s">"fmt"</span>
  <span class="s">"unsafe"</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">unsafe</span><span class="o">.</span><span class="n">Sizeof</span><span class="p">(</span><span class="k">struct</span><span class="p">{}{}))</span>  
    <span class="c">// 0</span>

  <span class="k">var</span> <span class="n">nilInterface</span> <span class="k">interface</span><span class="p">{}</span> <span class="o">=</span> <span class="no">nil</span>
  <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">unsafe</span><span class="o">.</span><span class="n">Sizeof</span><span class="p">(</span><span class="n">nilInterface</span><span class="p">))</span>  
    <span class="c">// 16</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p><code class="language-plaintext highlighter-rouge">빈 struct</code>는 메모리 자체를 할당받지 않는다. 즉 메모리에 없는 값이다. 반면 <code class="language-plaintext highlighter-rouge">nil interface</code>는 16Byte를 할당받는다.</p>

<p>그럼 빈 struct를 사용하면 메모리 할당이 적은가? 그건 또 아니다.</p>

<h3 id="bucket의-작동원리"><span class="me-2">Bucket의 작동원리</span><a href="#bucket의-작동원리" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><code class="language-plaintext highlighter-rouge">map</code>이 어떻게 구현되어 있는지 살펴보자.</p>

<div file="go/src/cmd/compile/internal/types/type.go" class="language-go highlighter-rouge"><div class="code-header">
        <span data-label-text="go/src/cmd/compile/internal/types/type.go"><i class="far fa-file-code fa-fw"></i></span>
      <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="c">// Map contains Type fields specific to maps.</span>
<span class="k">type</span> <span class="n">Map</span> <span class="k">struct</span> <span class="p">{</span>
  <span class="n">Key</span>  <span class="o">*</span><span class="n">Type</span> <span class="c">// Key type</span>
  <span class="n">Elem</span> <span class="o">*</span><span class="n">Type</span> <span class="c">// Val (elem) type</span>

  <span class="n">Bucket</span> <span class="o">*</span><span class="n">Type</span> <span class="c">// internal struct type representing a hash bucket</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p><code class="language-plaintext highlighter-rouge">Map</code>은 <code class="language-plaintext highlighter-rouge">key:value</code> 쌍과 <code class="language-plaintext highlighter-rouge">Bucket</code>을 갖는다. 특징적인 점은 <code class="language-plaintext highlighter-rouge">Bucket</code>을 가진다는 것이다. 조금 더 깊게 들어가보자.</p>

<div file="go/src/runtime/map.go" class="language-go highlighter-rouge"><div class="code-header">
        <span data-label-text="go/src/runtime/map.go"><i class="far fa-file-code fa-fw"></i></span>
      <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre></td><td class="rouge-code"><pre><span class="c">// A map is just a hash table. The data is arranged</span>
<span class="c">// into an array of buckets. Each bucket contains up to</span>
<span class="c">// 8 key/elem pairs. The low-order bits of the hash are</span>
<span class="c">// used to select a bucket. Each bucket contains a few</span>
<span class="c">// high-order bits of each hash to distinguish the entries</span>
<span class="c">// within a single bucket.</span>
<span class="c">//</span>
<span class="c">// If more than 8 keys hash to a bucket, we chain on</span>
<span class="c">// extra buckets.</span>
<span class="c">//</span>
<span class="c">// When the hashtable grows, we allocate a new array</span>
<span class="c">// of buckets twice as big. Buckets are incrementally</span>
<span class="c">// copied from the old bucket array to the new bucket array.</span>

<span class="c">// mapextra holds fields that are not present on all maps.</span>
<span class="k">type</span> <span class="n">mapextra</span> <span class="k">struct</span> <span class="p">{</span>
  <span class="c">// If both key and elem do not contain pointers and are inline, then we mark bucket</span>
  <span class="c">// type as containing no pointers. This avoids scanning such maps.</span>
  <span class="c">// However, bmap.overflow is a pointer. In order to keep overflow buckets</span>
  <span class="c">// alive, we store pointers to all overflow buckets in hmap.extra.overflow and hmap.extra.oldoverflow.</span>
  <span class="c">// overflow and oldoverflow are only used if key and elem do not contain pointers.</span>
  <span class="c">// overflow contains overflow buckets for hmap.buckets.</span>
  <span class="c">// oldoverflow contains overflow buckets for hmap.oldbuckets.</span>
  <span class="c">// The indirection allows to store a pointer to the slice in hiter.</span>
  <span class="n">overflow</span>    <span class="o">*</span><span class="p">[]</span><span class="o">*</span><span class="n">bmap</span>
  <span class="n">oldoverflow</span> <span class="o">*</span><span class="p">[]</span><span class="o">*</span><span class="n">bmap</span>

  <span class="c">// nextOverflow holds a pointer to a free overflow bucket.</span>
  <span class="n">nextOverflow</span> <span class="o">*</span><span class="n">bmap</span>
<span class="p">}</span>

</pre></td></tr></tbody></table></code></div></div>

<p>앞으로 <code class="language-plaintext highlighter-rouge">key:value</code> 쌍을 <code class="language-plaintext highlighter-rouge">entry</code>라고 부르겠다. <code class="language-plaintext highlighter-rouge">bucket</code>은 8쌍의 entry를 담고 있다. 그리고 <code class="language-plaintext highlighter-rouge">map</code>은 bucket의 배열로 데이터를 저장한다. 만약 bucket 내의 entry가 유효한 포인터를 가지고 있지 않으면 <code class="language-plaintext highlighter-rouge">overflow bucket</code>을 생성해 값을 할당한다. <code class="language-plaintext highlighter-rouge">overflow bucket</code>에 할당된 entry는 더 이상 <code class="language-plaintext highlighter-rouge">GC(Garbage collector)</code>에 스캔되지 않는다.</p>

<p><code class="language-plaintext highlighter-rouge">빈 struct</code>는 포인터를 가질 수 없다. 따라서 <code class="language-plaintext highlighter-rouge">overflow bucket</code>으로 분류될 것이다. 따라서 GC에 의해 스캔되지 않는다. 하지만 <code class="language-plaintext highlighter-rouge">nil interface</code>는 포인터가 될 수 있기 때문에 계속해서 GC에 스캔된다. 이는 속도를 느리게 만든다.</p>

<p>반면 <code class="language-plaintext highlighter-rouge">overflow bucket</code>을 계속해서 생성하면서 지속적인 메모리 할당이 발생한다는 단점이 있다. 이를 해결하기 위해서는 <code class="language-plaintext highlighter-rouge">map</code>을 초기화할 때 <code class="language-plaintext highlighter-rouge">capacity</code>를 크게 잡으면 된다. <code class="language-plaintext highlighter-rouge">map</code>은 메모리 공간이 부족할 때 2배씩 늘려가며 메모리를 확보한다. 따라서 처음부터 넉넉하게 메모리를 할당해두면 bucket을 생성하는 빈도가 줄어든다.</p>

<h3 id="결론"><span class="me-2">결론</span><a href="#결론" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>결론적으로 <code class="language-plaintext highlighter-rouge">빈 struct</code>를 사용하는 것이 성능(속도/ 메모리) 면에서 더 뛰어나다. 만약 <code class="language-plaintext highlighter-rouge">map</code>의 <code class="language-plaintext highlighter-rouge">capacity</code>까지 넉넉하게 초기화해주면 더욱 좋은 성능을 보인다.</p>

<p>참고: <a href="https://levelup.gitconnected.com/memory-allocation-and-performance-in-golang-maps-b267b5ad9217">memory-allocation-and-performance-in-golang-maps</a></p>

<hr />

<h2 id="go로-구현"><span class="me-2">Go로 구현</span><a href="#go로-구현" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p><code class="language-plaintext highlighter-rouge">PySet</code>의 주요 아이디어만 빌려와 <code class="language-plaintext highlighter-rouge">GoSet</code>을 만들어보자.</p>

<div class="language-go highlighter-rouge"><div class="code-header">
        <span data-label-text="Go"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="k">map</span><span class="p">[</span><span class="n">T</span><span class="p">]</span><span class="k">struct</span><span class="p">{}</span>
</pre></td></tr></tbody></table></code></div></div>

<p><code class="language-plaintext highlighter-rouge">Go</code>에서는 <code class="language-plaintext highlighter-rouge">map</code>을 통해 <code class="language-plaintext highlighter-rouge">Hash Table</code>을 만들 수 있다. key만 가지는 map이 간단하게 구현되었다.</p>

<p>간단한 코드로 <code class="language-plaintext highlighter-rouge">GoSet</code>이 잘 작동하는지 확인해보자.</p>

<div class="language-go highlighter-rouge"><div class="code-header">
        <span data-label-text="Go"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="k">import</span> <span class="p">(</span>
  <span class="s">"fmt"</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">data</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">int</span><span class="p">{</span><span class="m">7</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">6</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">5</span><span class="p">}</span>
    
  <span class="n">set</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="k">map</span><span class="p">[</span><span class="kt">int</span><span class="p">]</span><span class="k">struct</span><span class="p">{})</span>
  <span class="c">// add</span>
  <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">n</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">data</span> <span class="p">{</span>
  <span class="n">set</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="k">struct</span><span class="p">{}{}</span>
  <span class="p">}</span>

  <span class="c">// print</span>
  <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">_</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">set</span> <span class="p">{</span>
  <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"%d "</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="c">// 3 5 6 1 7 </span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>예상대로 값이 출력되었다. 주의할 점은 <code class="language-plaintext highlighter-rouge">map</code>의 <code class="language-plaintext highlighter-rouge">key</code>는 순서를 유지하지 않는다. 이 부분은 <code class="language-plaintext highlighter-rouge">PySet</code>, <code class="language-plaintext highlighter-rouge">PyDict</code>도 동일하다.</p>

<h3 id="type으로-구현"><span class="me-2">type으로 구현</span><a href="#type으로-구현" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>추상화를 통해 <code class="language-plaintext highlighter-rouge">set</code>을 일반화 시켜보자. <code class="language-plaintext highlighter-rouge">Generic</code>을 사용해 다양한 타입의 데이터를 담을 수 있도록 작성했다.</p>

<blockquote class="prompt-tip">
  <p>Generic은 Go v1.18에 처음 추가된 기능이다. 따라서 1.17이하의 버전에서는 정확히 Key의 데이터 타입을 명시한 후 사용해야 한다.</p>
</blockquote>

<div class="language-go highlighter-rouge"><div class="code-header">
        <span data-label-text="Go"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td><td class="rouge-code"><pre><span class="c">// Set 구현</span>
<span class="k">type</span> <span class="n">Set</span><span class="p">[</span><span class="n">T</span> <span class="n">comparable</span><span class="p">]</span> <span class="k">struct</span> <span class="p">{</span>
  <span class="n">table</span> <span class="k">map</span><span class="p">[</span><span class="n">T</span><span class="p">]</span><span class="k">struct</span><span class="p">{}</span>
<span class="p">}</span>

<span class="c">// 빈 Set 초기화</span>
<span class="k">func</span> <span class="n">NewSet</span><span class="p">[</span><span class="n">T</span> <span class="n">comparable</span><span class="p">]()</span> <span class="o">*</span><span class="n">Set</span><span class="p">[</span><span class="n">T</span><span class="p">]</span> <span class="p">{</span>
  <span class="n">emptySet</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="k">map</span><span class="p">[</span><span class="n">T</span><span class="p">]</span><span class="k">struct</span><span class="p">{})</span>
  <span class="k">return</span> <span class="o">&amp;</span><span class="n">Set</span><span class="p">[</span><span class="n">T</span><span class="p">]{</span><span class="n">emptySet</span><span class="p">}</span>
<span class="p">}</span>

<span class="c">// Set에 값 추가</span>
<span class="k">func</span> <span class="p">(</span><span class="n">s</span> <span class="o">*</span><span class="n">Set</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="n">Add</span><span class="p">(</span><span class="n">key</span> <span class="n">T</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">s</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="k">struct</span><span class="p">{}{}</span>
<span class="p">}</span>

<span class="c">// Set에 값이 있는지 확인</span>
<span class="k">func</span> <span class="p">(</span><span class="n">s</span> <span class="o">*</span><span class="n">Set</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="n">Has</span><span class="p">(</span><span class="n">key</span> <span class="n">T</span><span class="p">)</span> <span class="kt">bool</span> <span class="p">{</span>
  <span class="n">_</span><span class="p">,</span> <span class="n">ok</span> <span class="o">:=</span> <span class="n">s</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
  <span class="k">return</span> <span class="n">ok</span>
<span class="p">}</span>

<span class="c">// Set에서 값 삭제</span>
<span class="k">func</span> <span class="p">(</span><span class="n">s</span> <span class="o">*</span><span class="n">Set</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="n">Pop</span><span class="p">(</span><span class="n">key</span> <span class="n">T</span><span class="p">)</span> <span class="kt">bool</span> <span class="p">{</span>
  <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">Has</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="p">{</span>
  <span class="nb">delete</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">table</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
  <span class="k">return</span> <span class="no">true</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="no">false</span>
<span class="p">}</span>

<span class="c">// Set에 모든 값 출력</span>
<span class="k">func</span> <span class="p">(</span><span class="n">s</span> <span class="o">*</span><span class="n">Set</span><span class="p">[</span><span class="n">T</span><span class="p">])</span> <span class="n">PrintAll</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">_</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">s</span><span class="o">.</span><span class="n">table</span> <span class="p">{</span>
  <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"%d "</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="n">fmt</span><span class="o">.</span><span class="n">Print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>이제 <code class="language-plaintext highlighter-rouge">Set</code>을 사용해보자.</p>

<div class="language-go highlighter-rouge"><div class="code-header">
        <span data-label-text="Go"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="s">"fmt"</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">data</span> <span class="o">:=</span> <span class="p">[]</span><span class="kt">int</span><span class="p">{</span><span class="m">3</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">6</span><span class="p">,</span> <span class="m">7</span><span class="p">,</span> <span class="m">7</span><span class="p">}</span>
  <span class="n">set</span> <span class="o">:=</span> <span class="n">NewSet</span><span class="p">[</span><span class="kt">int</span><span class="p">]()</span>

  <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">n</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">data</span> <span class="p">{</span>
  <span class="n">set</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="n">set</span><span class="o">.</span><span class="n">PrintAll</span><span class="p">()</span> <span class="c">// 3 5 6 7 </span>
  <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">set</span><span class="o">.</span><span class="n">Has</span><span class="p">(</span><span class="m">5</span><span class="p">))</span> <span class="c">// true</span>

  <span class="n">ok</span> <span class="o">:=</span> <span class="n">set</span><span class="o">.</span><span class="n">Pop</span><span class="p">(</span><span class="m">7</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">ok</span> <span class="p">{</span>
  <span class="n">set</span><span class="o">.</span><span class="n">PrintAll</span><span class="p">()</span> <span class="c">// 5 6 3 </span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>예상한 대로 잘 작동하는 것을 볼 수 있다.</p>

<hr />

<h2 id="goset이-slice보다-빠를까"><span class="me-2">GoSet이 slice보다 빠를까?</span><a href="#goset이-slice보다-빠를까" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>중복을 제거할 때는 <code class="language-plaintext highlighter-rouge">Set</code>이 분명한 장점을 갖는다. 하지만 <code class="language-plaintext highlighter-rouge">Set</code>이 정말 탐색에서도 빠를까?</p>

<p>코드의 흐름은 다음과 같다.</p>

<ol>
  <li>9999999개의 정수를 각각 <code class="language-plaintext highlighter-rouge">slice</code>와 <code class="language-plaintext highlighter-rouge">Set</code>에 추가한다.</li>
  <li>이때 추가되는 값은 100 이하의 랜덤한 정수이다.</li>
  <li>마지막에 <code class="language-plaintext highlighter-rouge">slice</code>와 <code class="language-plaintext highlighter-rouge">Set</code>에 101을 각각 추가한다. (slice의 마지막에 101이 위치한다.)</li>
  <li><code class="language-plaintext highlighter-rouge">slice</code>와 <code class="language-plaintext highlighter-rouge">Set</code>에서 101을 탐색한다.</li>
</ol>

<div class="language-go highlighter-rouge"><div class="code-header">
        <span data-label-text="Go"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre></td><td class="rouge-code"><pre><span class="k">import</span> <span class="p">(</span>
  <span class="s">"fmt"</span>
  <span class="s">"math/rand"</span>
  <span class="s">"time"</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">lenData</span> <span class="o">:=</span> <span class="m">9999999</span>
  <span class="n">maxRandInt</span> <span class="o">:=</span> <span class="m">100</span>
  <span class="n">target</span> <span class="o">:=</span> <span class="n">maxRandInt</span> <span class="o">+</span> <span class="m">1</span>

  <span class="n">testSlice</span><span class="p">(</span><span class="n">lenData</span><span class="p">,</span> <span class="n">maxRandInt</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
  <span class="n">testSet</span><span class="p">(</span><span class="n">lenData</span><span class="p">,</span> <span class="n">maxRandInt</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">testSlice</span><span class="p">(</span><span class="n">lenData</span><span class="p">,</span> <span class="n">maxRandInt</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> <span class="p">{</span>
  <span class="c">// Slice 초기화 + 탐색 (최악의 경우)</span>
  <span class="n">start</span> <span class="o">:=</span> <span class="n">time</span><span class="o">.</span><span class="n">Now</span><span class="p">()</span>

  <span class="n">data</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">int</span><span class="p">,</span> <span class="m">0</span><span class="p">)</span> <span class="c">// Set과 같은 조건에서 시작</span>
  <span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">lenData</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
  <span class="n">data</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">rand</span><span class="o">.</span><span class="n">Intn</span><span class="p">(</span><span class="n">maxRandInt</span><span class="p">))</span>
  <span class="p">}</span>
  <span class="n">data</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">n</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">data</span> <span class="p">{</span>
  <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="n">target</span> <span class="p">{</span>
  <span class="k">break</span>
  <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">duration</span> <span class="o">:=</span> <span class="n">time</span><span class="o">.</span><span class="n">Since</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
  <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Slice으로 탐색"</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">testSet</span><span class="p">(</span><span class="n">lenData</span><span class="p">,</span> <span class="n">maxRandInt</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> <span class="p">{</span>
  <span class="c">// Set 초기화 + 탐색</span>
  <span class="n">start</span> <span class="o">:=</span> <span class="n">time</span><span class="o">.</span><span class="n">Now</span><span class="p">()</span>

  <span class="n">set</span> <span class="o">:=</span> <span class="n">NewSet</span><span class="p">[</span><span class="kt">int</span><span class="p">]()</span>
  <span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">lenData</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
  <span class="n">set</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">rand</span><span class="o">.</span><span class="n">Intn</span><span class="p">(</span><span class="n">maxRandInt</span><span class="p">))</span>
  <span class="p">}</span>
  <span class="n">set</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
  <span class="n">set</span><span class="o">.</span><span class="n">Has</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
  <span class="n">duration</span> <span class="o">:=</span> <span class="n">time</span><span class="o">.</span><span class="n">Since</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
  <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Set으로 탐색"</span><span class="p">,</span> <span class="n">duration</span><span class="p">)</span>
<span class="p">}</span>


<span class="c">// Slice으로 탐색 1.75740032s</span>
<span class="c">// Set으로 탐색 1.343899904s</span>
</pre></td></tr></tbody></table></code></div></div>

<p>예상대로 <code class="language-plaintext highlighter-rouge">Set</code>이 빠르다. 하지만 <code class="language-plaintext highlighter-rouge">slice</code>의 크기가 작다면 어떨까?</p>

<p><code class="language-plaintext highlighter-rouge">lenData</code>를 99999로 줄이고 실행해봤다.</p>

<div class="language-go highlighter-rouge"><div class="code-header">
        <span data-label-text="Go"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">lenData</span> <span class="o">:=</span> <span class="m">99999</span>
<span class="c">// Slice으로 탐색 9.400064ms</span>
<span class="c">// Set으로 탐색 37.700096ms</span>
</pre></td></tr></tbody></table></code></div></div>

<p><code class="language-plaintext highlighter-rouge">Set</code>이 훨씬 유리한 조건이었음에도 <code class="language-plaintext highlighter-rouge">slice</code>가 더 빠르다. 정확히는 <code class="language-plaintext highlighter-rouge">map</code>의 초기화가 느린 것이다.</p>

<p>같은 조건에서 초기화 시간을 제외하고 순수 탐색에 사용한 시간을 측정해 봤다.</p>

<div class="language-go highlighter-rouge"><div class="code-header">
        <span data-label-text="Go"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed=""><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">lenData</span> <span class="o">:=</span> <span class="m">99999</span>
<span class="c">// Slice으로 탐색 99.84µs</span>
<span class="c">// Set으로 탐색 0s</span>
</pre></td></tr></tbody></table></code></div></div>

<p><code class="language-plaintext highlighter-rouge">Set</code>이 더 빠르다. 따라서 탐색할 상황이 많다면 <code class="language-plaintext highlighter-rouge">Set</code>이 유리하다. 하지만 탐색이 많이 일어나지 않고, 데이터가 충분히 크지 않다면 오히려 무식하게 <code class="language-plaintext highlighter-rouge">slice</code>로 탐색하는 게 더 빠를 수 있다.</p>

</div>


<div class="post-tail-wrapper text-muted">

  <!-- categories -->
  
    <div class="post-meta mb-3">
      <i class="far fa-folder-open fa-fw me-1"></i>
      
        <a href="/categories/playground/">Playground</a>
    </div>
  

  <!-- tags -->
  
  <div class="post-tags">
    <i class="fa fa-tags fa-fw me-1"></i>
    
    <a href="/tags/go/" class="post-tag no-text-decoration">Go</a>
    
    <a href="/tags/python/" class="post-tag no-text-decoration">Python</a>
    
  </div>
  

  <div class="post-tail-bottom
    d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
    <div class="license-wrapper">
      
        

        이 글은 저작권자의 
        <a href="https://creativecommons.org/licenses/by-nc/4.0/">
          CC BY-NC 4.0
        </a>
         라이센스를 따릅니다.
      
    </div>

    <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted me-1">공유하기</span>
  <span class="share-icons">
    
    
    

    
      
      <a
        href="https://twitter.com/intent/tweet?text=PySet%EC%9D%84%20Go%EB%8B%B5%EA%B2%8C%20-%20Palette&url=https%3A%2F%2Fdenev6.github.io%2Fplayground%2F2023%2F10%2F03%2Fgoset.html"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Twitter"
        target="_blank"
        rel="noopener"
        aria-label="Twitter"
      >
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    
      
      <a
        href="https://www.facebook.com/sharer/sharer.php?title=PySet%EC%9D%84%20Go%EB%8B%B5%EA%B2%8C%20-%20Palette&u=https%3A%2F%2Fdenev6.github.io%2Fplayground%2F2023%2F10%2F03%2Fgoset.html"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Facebook"
        target="_blank"
        rel="noopener"
        aria-label="Facebook"
      >
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    
      
      <a
        href="https://t.me/share/url?url=https%3A%2F%2Fdenev6.github.io%2Fplayground%2F2023%2F10%2F03%2Fgoset.html&text=PySet%EC%9D%84%20Go%EB%8B%B5%EA%B2%8C%20-%20Palette"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Telegram"
        target="_blank"
        rel="noopener"
        aria-label="Telegram"
      >
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    
      
      <a
        href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fdenev6.github.io%2Fplayground%2F2023%2F10%2F03%2Fgoset.html"
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Linkedin"
        target="_blank"
        rel="noopener"
        aria-label="Linkedin"
      >
        <i class="fa-fw fab fa-linkedin"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="링크 복사하기"
      data-title-succeed="링크가 복사되었습니다!"
    >
      <i class="fa-fw fas fa-link pe-none"></i>
    </button>
  </span>
</div>

  </div>
  <!-- .post-tail-bottom -->
</div>
<!-- div.post-tail-wrapper -->


  

  
</article>

          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get the last 5 posts from lastmod list. -->














  <section id="access-lastmod">
    <h2 class="panel-heading">최근 수정</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/playground/2025/01/17/ml-api.html">FastAPI 기반 딥러닝 모델 API 구축하기</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/projects/2025/03/05/eeg-transformer.html">EEG 신호를 활용한 청소년 ADHD 진단</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/projects/2025/05/24/dacon-bias.html">프롬프트 엔지니어링으로 LLM 편향 줄이기</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/projects/2022/10/07/face-mouse-control.html">얼굴 인식을 이용한 마우스 제어</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/study/2025/07/04/long-term-memory.html">네이버가 말하는 의료 챗봇과 장기 기억</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">인기 태그</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ai/">AI</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cv/">CV</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/python/">Python</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/llm/">LLM</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/c/">C++</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/nlp/">NLP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/go/">Go</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/hci/">HCI</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/mlops/">MLOps</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pytorch/">Pytorch</a>
      
    </div>
  </section>


            </div>

            
              
              



  <section id="toc-wrapper" class="ps-0 pe-4 mb-5">
    <h2 class="panel-heading ps-3 pt-2 mb-2">바로가기</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
                
                <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->














  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">관련된 글</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/study/2025/01/27/hog.html" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
    class="small"
  
  data-ts="1737903600"
  data-df="YYYY/MM/DD"
  
>
  2025/01/27
</time>

              <h4 class="pt-0 my-2">Histograms of Oriented Gradients for Human Detection</h4>
              <div class="text-muted small">
                <p>
                  





                  Histograms of Oriented Gradients for Human Detection(vision.stanford) 논문을 바탕으로 HOG descriptor 작동 원리에 대해 분석한다. 논문을 완전히 번역하는 것이 아닌 내용을 분석하고 정리한 글이다. 따라서 실제 논문 목차와 다르며, 필자의 설명이 추가되었다.

본 글에서 gradient는...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/study/2025/01/29/vae.html" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
    class="small"
  
  data-ts="1738076400"
  data-df="YYYY/MM/DD"
  
>
  2025/01/29
</time>

              <h4 class="pt-0 my-2">Auto-Encoding Variational Bayes</h4>
              <div class="text-muted small">
                <p>
                  





                  Auto Encoder

Variational Auto-Encoding을 이해하기 위해 기본적인 Auto-Encoding을 알아야 한다.



Auto Encoder(AE)는 데이터를 압축하고 복원하는 단순한 모델이다. Linear layer을 통해 데이터 크기를 줄이고 복원한다. Auto Encoder 구성은 다음과 같다.


  Encoder: 데...
                </p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/study/2025/01/31/alexnet.html" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
    class="small"
  
  data-ts="1738249200"
  data-df="YYYY/MM/DD"
  
>
  2025/01/31
</time>

              <h4 class="pt-0 my-2">ImageNet Classification with Deep Convolutional Neural Networks</h4>
              <div class="text-muted small">
                <p>
                  





                  ImageNet Classification with Deep Convolutional Neural Networks: 논문은 AlexNet을 소개한 논문으로 CNN 모델의 각 레이어가 어떤 역할을 하는지 잘 분석했다.

논문을 정리한 글이며, CNN의 기본적인 개념을 생략하고 정리했다. 자세한 부분은 BLOG: CNN에 볼 수 있다.

본 글에서 분석을...
                </p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


              
                
                <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/playground/2023/09/23/faster-go.html"
      class="btn btn-outline-primary"
      aria-label="이전 글"
    >
      <p>Go를 빠르게 굴리기</p>
    </a>
  

  
    <a
      href="/study/2024/04/10/transformer.html"
      class="btn btn-outline-primary"
      aria-label="다음 글"
    >
      <p>Attention is all you need</p>
    </a>
  
</nav>

              
                
                <!--  The comments switcher -->


              
            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>
    ©
    <time>2025</time>
    <a href="https://github.com/denev6">박성진</a>.
    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="명시되지 않는 한 이 사이트의 블로그 게시물은 작성자의 Creative Commons Attribution 4.0 International(CC BY-NC 4.0) 라이선스에 따라 사용이 허가되었습니다."
      >일부 권리 보유</span>
    
  </p>

  <p>Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center unloaded">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">인기 태그</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ai/">AI</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/cv/">CV</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/python/">Python</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/llm/">LLM</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/c/">C++</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/nlp/">NLP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/go/">Go</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/hci/">HCI</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/mlops/">MLOps</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/pytorch/">Pytorch</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask"></div>

    

    <!-- JavaScripts -->

    <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.7.1/dist/jquery.min.js,npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.9/dayjs.min.js,npm/dayjs@1.11.9/locale/ko.min.js,npm/dayjs@1.11.9/plugin/relativeTime.min.js,npm/dayjs@1.11.9/plugin/localizedFormat.min.js,npm/tocbot@4.21.1/dist/tocbot.min.js"></script>






<script defer src="/assets/js/dist/post.min.js"></script>






    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  /* Note: dependent library will be loaded in `js-selector.html` */
  SimpleJekyllSearch({
    searchInput: document.getElementById('search-input'),
    resultsContainer: document.getElementById('search-results'),
    json: '/assets/js/data/search.json',
    searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
    noResultsText: '<p class="mt-5"></p>',
    templateMiddleware: function(prop, value, template) {
      if (prop === 'categories') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
        }
      }

      if (prop === 'tags') {
        if (value === '') {
          return `${value}`;
        } else {
          return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
        }
      }
    }
  });
</script>

  </body>
</html>
